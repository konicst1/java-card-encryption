//Test script for Applet 'ClassicApplet1'

powerup;
//1 Select ClassicApplet1 //aid/E90801554B/DE
0x00 0xA4 0x04 0x00 0X06 0XE9 0X08 0X01 0X55 0X4B 0XDF 0x7F;

//CLA INS P1      P2       Lc                     data                      Le
//80  var param1  param2   delka dat(0x00)   <data>(nepovinne)         delka odpovedi (0x7f)

//2 say my name (0x00)
0x80 0x00 0x00 0x00 0x00 0x08;

//3 encrypt a sign
0x80 0x42 0x00 0x00 0x10 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x10 0x11 0x12 0x13 0x14 0x15 0x16 0x20;

//4 decrypt and verify
0x80 0x44 0x00 0x00 0x20 0x7d 0x3f 0xe8 0x10 0x13 0x8e 0x35 0x7c 0xbc 0x73 0x5a 0x1e 0xeb 0x4f 0xfb 0x40 0xe7 0xac 0xbe 0x9b 0xef 0xb2 0x75 0x16 0xf2 0x14 0x64 0x7f 0xb2 0x5f 0xab 0x5d 0x10;

//5 encrypt wrong data length
0x80 0x42 0x00 0x00 0x11 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x10 0x11 0x12 0x13 0x14 0x15 0x16 0x17 0x20;

//6 decrypt tampered data
0x80 0x44 0x00 0x00 0x20 0x7d 0x3f 0xe8 0x10 0x14 0x1e 0x35 0x7c 0xbc 0x73 0x5a 0x1e 0xeb 0x4f 0xfb 0x40 0xe7 0xac 0xbe 0x9b 0xef 0xb2 0x75 0x16 0xf2 0x14 0x64 0x7f 0xb2 0x5f 0xab 0x5d 0x10;

//7 decrypt with wrong mac code
0x80 0x44 0x00 0x00 0x20 0x7d 0x3f 0xe8 0x10 0x13 0x8e 0x35 0x7c 0xbc 0x73 0x5a 0x1e 0xeb 0x4f 0xfb 0x40 0xe7 0xac 0xbe 0x9b 0xef 0xb2 0x75 0x16 0xf2 0x14 0x64 0x7f 0xb3 0x5f 0xab 0x5d 0x10;


//8 too much data
0x80 0x01 0x00 0x00 0x15 0x01 0x02 0x03 0x04 0x05 0x01 0x02 0x03 0x04 0x05 0x01 0x02 0x03 0x04 0x05 0x01 0x02 0x03 0x04 0x05 0x01 0x7f;


//9 read data (0x01)
0x80 0x01 0x00 0x00 0x05 0x01 0x02 0x03 0x04 0x05 0x7f;

//10 send data
0x80 0x02 0x00 0x00 0x00 0x05;


//11 verify pin
0x80 0x20 0x00 0x00 0x04 0x01 0x02 0x03 0x04 0x7f;

//12 too much data
0x80 0x01 0x00 0x00 0x15 0x01 0x02 0x03 0x04 0x05 0x01 0x02 0x03 0x04 0x05 0x01 0x02 0x03 0x04 0x05 0x01 0x02 0x03 0x04 0x05 0x01 0x7f;


//13 read data (0x01)
0x80 0x01 0x00 0x00 0x05 0x01 0x02 0x03 0x04 0x05 0x7f;

//14 send data
0x80 0x02 0x00 0x00 0x00 0x05;

//15-16-17 1enter wrong pin three times
0x80 0x20 0x00 0x00 0x04 0x01 0x02 0x03 0x06 0x7f;
0x80 0x20 0x00 0x00 0x04 0x01 0x02 0x03 0x06 0x7f;
0x80 0x20 0x00 0x00 0x04 0x01 0x02 0x03 0x06 0x7f;

//18 try if card is blocked
0x80 0x00 0x00 0x00 0x00 0x08;

powerdown;
